import pandas as pd
import glob
import csv

base_dir = "/Users/martinwu/Documents/ITU/MsC/Thesis/Thesis-ObjectCollector/Assets/Scripts/Statistics"
read_dir = base_dir + "/AuctionFrontier_ProblemB/AuctionFrontier_Sparse10"

all_files = glob.glob(read_dir + "/*.csv")

 
# Id  NumOfAgents  CompletionTime  MinReward  ...  AvgDistTravelled  MaxDistTravelled  SDDistTravelled  TotalShares
# Writing to file
dff = pd.DataFrame()
for filename in all_files:
    df = pd.read_csv(filename)

    entry = dict()
    entry["agents_num"] = df["NumOfAgents"].mean()
    # Completion time
    entry["complete_time_avg"] = df["CompletionTime"].mean() 


    # Distance
    entry["dist_travelled_avg"] = df["AvgDistTravelled"].mean() 
    entry["totaldist"] = entry["agents_num"] * df["AvgDistTravelled"].mean() 
    entry["dist_travelled_avg_std"] = df["AvgDistTravelled"].std() 

    entry["max_dist_travelled_avg"] = df["MaxDistTravelled"].mean() 
    entry["max_dist_travelled_std"] = df["MaxDistTravelled"].std() 

    entry["min_dist_travelled_avg"] = df["MinDistTravelled"].mean() 
    entry["min_dist_travelled_std"] = df["MinDistTravelled"].std() 

    # Cells discovered
    entry["cell_discovered_avg"] = df["AvgAgentStep"].mean() 
    entry["max_cell_discovered_avg"] = df["MaxAgentStep"].mean() 
    entry["max_cell_discovered_std"] = df["MaxAgentStep"].std() 
    entry["min_cell_discovered_avg"] = df["MinAgentStep"].mean() 
    entry["min_cell_discovered_std"] = df["MinAgentStep"].std() 

    # Object Collected
    entry["obj_collected_avg"] = df["AvgReward"].mean() 
    entry["max_obj_collected_avg"] = df["MaxReward"].mean() 
    entry["max_obj_collected_std"] = df["MaxReward"].std() 
    entry["min_obj_collected_avg"] = df["MinReward"].mean() 
    entry["min_obj_collected_std"] = df["MinReward"].std() 

    #print(entry)
    df_dictionary = pd.DataFrame([entry])
    dff = pd.concat([dff, df_dictionary], ignore_index=True)


dff.to_csv(read_dir+"/AuctionFrontierC_Sparse10_Result.csv", sep=',', mode='a')
